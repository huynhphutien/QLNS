<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<link rel="stylesheet" type="text/css" href="app.css">
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
		<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
		<title><%= title %> - Trang tin điện tử</title>
	</head>	
	<body>
			<div id="container">

				<div id="phantren">
					<img src="\images\banner.png" class="banner" />
					<style>
						.banner {
							width: 100%;
							height: auto;
						}
					</style>
				</div>

				<!-- Menu ngang -->
				<div class="menu-wrapper">
					<div class="phanmenungang1">
						<div class="menu-item active">
							<a class="menungang" href="/">
							  <span class="material-icons">home</span> Trang chủ 
							</a>
						</div>
					</div>

					<div class="phanmenungang2">
						<form class="search-form" action="#" method="get" id="formTimKiem">
							<input type="text" placeholder="Tìm kiếm..." name="q" id="inputTimKiem">
							<button type="submit">
							  <span class="material-icons">search</span>
							</button>
						</form>
						<script>
						  function toggleMenu() {
							const menu = document.getElementById("myMenu");
							menu.style.display = menu.style.display === "block" ? "none" : "block";
						  }

						  // Tự động ẩn khi click ra ngoài
						  document.addEventListener("click", function(event) {
							const menu = document.getElementById("myMenu");
							const button = document.querySelector(".menu-button");
							if (!menu.contains(event.target) && !button.contains(event.target)) {
							  menu.style.display = "none";
							}
						  });
						</script>
					</div>

					
					<div class="phanmenungang3">
						
						<div class="avatar-container">
						  <a href="#" class="avatar-link">
							<img src="/images/images.png" alt="Avatar" class="avatar">
						  </a>
						  <div class="avatar-info">
							<% if(session.QuyenHan == "admin") { %>
							<p class="nhan-vien">
									<span class="material-icons">person</span>
									<a href="/nhanvien">Nhân viên</a>
							</p>
							<p class="phong-ban">
									<span class="material-icons">domain</span>
									<a href="/phongban">Phòng ban</a>
							</p>
							<p class="chuc-vu">
									<span class="material-icons">badge</span>
									<a href="/chucvu">Chức vụ</a>
							</p>
							<p class="bang-luong">
									<span class="material-icons">book</span>
									<a href="/luong">Bảng lương</a>
							</p>
							<p class="ngay-cong">
									<span class="material-icons">event</span>
									<a href="/chamcong">Ngày công</a>
							</p>
							<p class="tai-khoan">
									<span class="material-icons">attribution</span>
									<a href="/taikhoan">Tài khoản</a>
							</p>
							<p class="quan-ly">
									<span class="material-icons">settings</span>
									<a href="/admin">Quản lý</a>
							</p>
							<% } %>
							<p class="dang-xuat">
								<span class="material-icons">logout</span> 
								<a href="/dangnhap">Đăng xuất</a>
							</p>
						  </div>
						  <script>
								document.querySelector('.avatar-link').addEventListener('click', function(event) {
								  event.preventDefault();  // Ngừng hành động mặc định của liên kết
								  const infoBox = document.querySelector('.avatar-info');
								  // Toggle hiển thị thông tin
								  if (infoBox.style.display === 'none' || infoBox.style.display === '') {
									infoBox.style.display = 'block';
								  } else {
									infoBox.style.display = 'none';
								  }
								});
						  </script>
						</div>

					</div>
				</div>


				<!-- Cột trái -->
				<div id="phantrai">
					<div class="dropdown-toggle" onclick="toggleDanhMuc()">
						  <span class="material-icons">menu</span>
						  <span>Danh mục</span>
						</div>

						<div class="danhmuc-list" id="danhmucList">
						 <a href="nhanvien" onclick="loadDanhMuc('/nguoidung', this)">Danh sách nhân viên</a>
						  <a href="baiviet" onclick="loadDanhMuc('/baiviet', this)">Danh sách bài viết</a>
						  <a href="chude" onclick="loadDanhMuc('/chude', this)">Danh sách chủ đề</a>
						  <a href="taikhoan" onclick="loadDanhMuc('/taikhoan', this)">Danh sách tài khoản</a>
						  <a href="chucvu" onclick="loadDanhMuc('/chucvu', this)">Danh sách chức vụ</a>
						  <a href="phongban" onclick="loadDanhMuc('/phongban', this)">Danh sách phòng ban</a>
						  <a href="chamcong" onclick="loadDanhMuc('/chanmcong', this)">Danh sách ngày công</a>
						  <a href="luong" onclick="loadDanhMuc('/luong', this)">Danh sách lương nhân viên</a>
						  <a href="nhiemvu" onclick="loadDanhMuc('/nhiemvu', this)">Danh sách nhiệm vụ</a>
						  <a href="baocao" onclick="loadDanhMuc('/baocao', this)">Danh sách báo cáo</a>

					</div>
					
					
					<script>

						function loadDanhMuc(url, element) {
							fetch(url)
								.then(response => {
									if (!response.ok) throw new Error("Không thể tải nội dung.");
									return response.text();
								})
								.then(html => {
									document.getElementById('phangiua').innerHTML = html;
								})
								.catch(error => {
									console.error('Lỗi:', error);
									document.getElementById('phangiua').innerHTML = `<p class="text-danger">Lỗi khi tải dữ liệu: ${error.message}</p>`;
								});
						}
					</script>
				</div>

				<div id="phangiua">
					<div class="card-body table-responsive">
						<a href="/baiviet/them" class="btn btn-primary mb-2"><i class="bi bi-plus-lg"></i> Đăng bài viết</a>
							 <table class="table table-bordered table-hover table-sm mb-0">
							 <thead>
							 <tr>
							 <th width="5%">#</th>
							 <th width="10%">Người đăng</th>
							 <th width="10%">Chủ đề</th>
							 <th width="40%">Tiêu đề</th>
							 <th width="10%">Ngày đăng</th>
							 <th width="5%">Hình ảnh</th>
							 <th width="5%">Sửa</th>
							 <th width="5%">Xóa</th>
							 </tr>
							 </thead>
							 <tbody>
							 <% var stt = 1; %>
							 <% baiviet.forEach(bv => { %>
							 <tr>
							 <td class="align-middle"><%= stt++ %></td>
							 <td class="align-middle small"><%= bv.TaiKhoan.HoVaTen %></td>
							 <td class="align-middle small"><%= bv.ChuDe.TenChuDe %></td>
							 <td class="align-middle small"><%= bv.TieuDe %></td>
							 <td class="align-middle small"><%= new Date(bv.NgayDang.toISOString()).toLocaleString("vi-VN") %></td>
							 <td class="align-middle"><%= bv.HinhAnh %></td>
							<td class="align-middle text-center">
							 <a href="/baiviet/sua/<%= bv._id %>"><i class="bi bi-pencil-square"></i></a>
							 </td>
							<td class="align-middle text-center">
							 <a href="/baiviet/xoa/<%= bv._id %>" onclick="return confirm('Bạn có muốn xóa bài viết <%= bv.TieuDe %> không?');">
							 <i class="bi bi-trash text-danger"></i>
							 </a>
							 </td>
							 </tr>
							 <% }); %>
							 </tbody>
							 </table>
					</div>

			</div>
		</div>
	</body>


</html>